<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Internship Officer Homepage</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet"/>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet"/>
    <link rel="stylesheet" href="style_fac.css"/>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>

<body class="bg-white-100">
    <input type="checkbox" id="menu-toggle" class="hidden">
 
    <div class="flex flex-col min-h-screen">
 
        <!-- Main Content -->
        <div class="flex flex-1">

            <!-- Main Section -->
            <main class="flex-1 p-6">
                <div class="main-card">
                    <div class="flex justify-between items-center mb-4">
                        <h2 class="text-2xl font-bold">03/12/2025</h2>
                        <p class="text-sm text-gray-600">You previously logged in on Saturday, March 09, 2025 at 01:59 PM</p>
                    </div>
 
                    <div class="flex space-x-4">
                        <div class="user-card"> <p class="text-lg font-bold">214</p> <p>Total Users</p> </div>
                        <div class="user-card"> <p class="text-lg font-bold">130</p> <p>Student Intern</p> </div>
                        <div class="user-card"> <p class="text-lg font-bold">1</p> <p>Internship Officer</p> </div>
                        <div class="user-card"> <p class="text-lg font-bold">36</p> <p>Program Director</p> </div>
                        <div class="user-card"> <p class="text-lg font-bold">5</p> <p>Executive Director</p> </div>
                    
                    </div>

                    <h2 id="academicYearLabel" class="text-2xl font-bold mb-4 text-center"></h2>
                    <table class="calendar-table">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Event</th>
                            </tr>
                        </thead>
                        <tbody>
                           
                        </tbody>
                    </table>
 
                    <div class="flex justify-between items-center mt-4">
                        <button class="btn">Set Event</button>
                        <button class="btn" onclick="openYearModal()">Change Academic Year</button>
                    </div>
                </div>
                
<!-- Change Academic Year Modal -->
<div id="yearModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-sm">
        <h2 class="text-lg font-bold mb-4">Change Academic Year</h2>
        <label class="block mb-1">Start Date</label>
        <input type="date" id="startYearInput" class="border p-2 w-full rounded mb-2" />
        <label class="block mb-1">End Date</label>
        <input type="date" id="endYearInput" class="border p-2 w-full rounded mb-4" />
        <div class="flex justify-end space-x-2">
            <button onclick="closeYearModal()" class="btn bg-gray-300 hover:bg-gray-400 text-black">Cancel</button>
            <button onclick="changeAcademicYear()" class="btn">Save</button>
        </div>
    </div>
</div>


<!-- Modal for Setting an Event -->
<div id="eventModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-white p-6 rounded-lg shadow-lg w-full max-w-sm">
        <h2 class="text-lg font-bold mb-4">Set Internship Event</h2>
        <label class="block mb-1">Start Date</label>
        <input type="date" id="eventStartDate" class="border p-2 w-full rounded mb-2" />
        <label class="block mb-1">End Date</label>
        <input type="date" id="eventEndDate" class="border p-2 w-full rounded mb-2" />
        <input type="text" id="eventName" placeholder="Event Name" class="border p-2 w-full rounded mb-4" />
        <div class="flex justify-end space-x-2">
            <button onclick="closeEventModal()" class="btn bg-gray-300 hover:bg-gray-400 text-black">Cancel</button>
            <button onclick="addEvent()" class="btn">Add Event</button>
        </div>
    </div>
</div>

 
                <!-- Intern Tracking Section -->
<div class="grid grid-cols-3 gap-4 mt-6">
    <!-- Intern1 Card -->
    <div class="stats-card">
        <h3 class="text-lg font-bold">Intern1</h3>
        <div class="flex justify-between">
            <div class="text-center">
                <p class="text-2xl font-bold">10</p>
                <p class="text-gray-500">New</p>
            </div>
            <div class="text-center">
                <p class="text-2xl font-bold">13</p>
                <p class="text-gray-500">Active</p>
            </div>
            <div class="text-center">
                <p class="text-2xl font-bold">31</p>
                <p class="text-gray-500">Completed</p>
            </div>
        </div>
    </div>
 
    <!-- Progress Card -->
    <div class="stats-card">
        <h3 class="text-lg font-bold">Progress</h3>
        <div class="flex justify-between">
            <div class="text-center">
                <p class="text-2xl font-bold">40</p>
                <p class="text-gray-500">New</p>
            </div>
            <div class="text-center">
                <p class="text-2xl font-bold">90</p>
                <p class="text-gray-500">Active</p>
            </div>
            <div class="text-center">
                <p class="text-2xl font-bold">20</p>
                <p class="text-gray-500">Completed</p>
                <div class="mt-4">
                    <button onclick="notifyRemaining()" class="bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded">
                      Notify Remaining
                    </button>
                  </div>
                  
            </div>
        </div>
    </div>
 
 <!-- Intern Evaluation Form Tracking Card -->
<div class="bg-white p-4 rounded-lg shadow-md">
    <label for="academicYearSelect" class="block mb-2 font-medium">Select Academic Year:</label>
<select id="academicYearSelect" class="mb-4 border p-2 rounded w-full">
  <option value="">-- Select Year --</option>
  <option value="2024-2025">2024-2025</option>
  <option value="2023-2024">2023-2024</option>
  <!-- Add more as needed -->
</select>

    <h2 class="text-lg font-bold mb-4">Intern Evaluation Form Tracking</h2>
    <input type="file" id="excelFile" accept=".xlsx" class="mb-4 border p-2 rounded w-full" />
    <canvas id="schoolChart" class="w-full"></canvas>
    <div class="mt-4">
      <p class="font-semibold mb-2">Evaluation Form Status</p>
      <ul id="statusList" class="text-sm text-gray-700 space-y-1"></ul>
    </div>
  </div>
  
 
                <!-- Internship Officer Profile -->
                <div class="profile-card">
                    <img src="https://th.bing.com/th/id/OIP.fXLkbSOJEBn5W1jRnNQc6wAAAA?rs=1&pid=ImgDetMain" alt="Mr. Sen S. Ei" class="profile-img"/>
                    <div>
                        <h4 class="text-lg font-bold">Mr. Sen S. Ei</h4>
                        <p class="text-sm text-gray-600">Internship Officer of the School of Management for the Academic Year 2024-2025</p>
                        <a href="#" class="text-blue-500">View Complete Profile</a>
    <!-- <script src="https://cdn.tailwindcss.com"></script> -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="/static\css\components.css">
    <link rel="stylesheet" href="home.css" />
</head>

<body class="content">
    <h1 id="greeting">Good day, Mr. John Park!</h1>
  
    <p class="date">Wednesday, March 12, 2025</p>
    <script src="/templates/_components/date.js"></script>

    <div class="box-shadow">
        <div class="content-card">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold">03/12/2025</h2>
                <p class="text-sm text-gray-600">You previously logged in on Saturday, March 09, 2025 at 01:59
                    PM</p>
            </div>

            <div class="flex space-x-4">
                <div class="user-card">
                    <p class="text-lg font-bold">214</p>
                    <p>Total Users</p>
                </div>
                <div class="user-card">
                    <p class="text-lg font-bold">130</p>
                    <p>Student Intern</p>
                </div>
                <div class="user-card">
                    <p class="text-lg font-bold">1</p>
                    <p>Internship Officer</p>
                </div>
                <div class="user-card">
                    <p class="text-lg font-bold">36</p>
                    <p>Program Director</p>
                </div>
                <div class="user-card">
                    <p class="text-lg font-bold">5</p>
                    <p>Executive Director</p>
                </div>

            </div>

            <h3 class="text-xl font-bold mt-4">Internship Calendar Events for the Academic Year 2024-2025</h3>
            <table class="calendar-table">
                <thead>
                    <tr>
                        <th>Date</th>
                        <th>Event</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>September 1</td>
                        <td>INTERNS' End</td>
                    </tr>
                    <tr>
                        <td>August 30</td>
                        <td>INTERNS' End</td>
                    </tr>
                    <tr>
                        <td>December 16</td>
                        <td>Internship Consultation</td>
                    </tr>
                </tbody>
            </table>

            <div class="flex justify-between items-center mt-4">
                <button class="btn">Set Event</button>
                <button class="btn">Change Academic Year</button>
            </div>
        </div>
    </div>

    <div class="box-shadow">
        <div class="content-card">
            <div class="grid grid-cols-3 gap-4 mt-6">
                <!-- Intern1 Card -->
                <div class="stats-card">
                    <h3 class="text-lg font-bold">Intern1</h3>
                    <div class="flex justify-between">
                        <div class="text-center">
                            <p class="text-2xl font-bold">10</p>
                            <p class="text-gray-500">New</p>
                        </div>
                        <div class="text-center">
                            <p class="text-2xl font-bold">13</p>
                            <p class="text-gray-500">Active</p>
                        </div>
                        <div class="text-center">
                            <p class="text-2xl font-bold">31</p>
                            <p class="text-gray-500">Completed</p>
                        </div>
                    </div>
                </div>

                <!-- Progress Card -->
                <div class="stats-card">
                    <h3 class="text-lg font-bold">Progress</h3>
                    <div class="flex justify-between">
                        <div class="text-center">
                            <p class="text-2xl font-bold">40</p>
                            <p class="text-gray-500">New</p>
                        </div>
                        <div class="text-center">
                            <p class="text-2xl font-bold">90</p>
                            <p class="text-gray-500">Active</p>
                        </div>
                        <div class="text-center">
                            <p class="text-2xl font-bold">20</p>
                            <p class="text-gray-500">Completed</p>
                        </div>
                    </div>
                </div>

                <!-- Interns Chart Card -->
                <div class="stats-card">
                    <h3 class="text-lg font-bold">130 Interns</h3>
                    <img src="https://www.ielts-mentor.com/images/writingsamples/ielts-pie-chart245-important-aspects-internship-students-have-learned.png"
                        alt="Interns Tracking" class="w-full rounded" />
                </div>
            </div>
        </div>
    </div>

    <div class="box-shadow">
        <div class="content-card">
            <div class="profile-card">
                <img src="https://th.bing.com/th/id/OIP.fXLkbSOJEBn5W1jRnNQc6wAAAA?rs=1&pid=ImgDetMain" alt="Mr. Sen S. Ei"
                    class="profile-img" />
                <div>
                    <h4 class="text-lg font-bold">Mr. Sen S. Ei</h4>
                    <p class="text-sm text-gray-600">Internship Officer of the School of Management for the Academic
                        Year 2024-2025</p>
                    <a href="#" class="text-blue-500">View Complete Profile</a>
                </div>
            </div>
        </div>
    </div>

    <script>

        // Show event modal
        document.querySelector(".btn").addEventListener("click", () => {
            eventModal.classList.remove("hidden");
        });
    
        function closeEventModal() {
            eventModal.classList.add("hidden");
        }
    
        function formatDateRange(start, end) {
            const options = { month: 'long', day: 'numeric' };
            const startDate = new Date(start);
            const endDate = new Date(end);
    
            if (start === end || end === '') {
                return startDate.toLocaleDateString(undefined, options);
            }
    
            if (startDate.getMonth() === endDate.getMonth()) {
                return `${startDate.toLocaleDateString(undefined, { month: 'long' })} ${startDate.getDate()}–${endDate.getDate()}`;
            }
    
            return `${startDate.toLocaleDateString(undefined, options)}–${endDate.toLocaleDateString(undefined, options)}`;
        }
    
        function addEvent() {
            const start = document.getElementById("eventStartDate").value;
            const end = document.getElementById("eventEndDate").value || start;
            const name = document.getElementById("eventName").value;
    
            if (!start || !name) {
                alert("Please enter at least a start date and event name.");
                return;
            }
    
            const range = formatDateRange(start, end);
            const table = document.querySelector(".calendar-table tbody");
            const newRow = document.createElement("tr");
            newRow.innerHTML = `<td>${range}</td><td>${name}</td>`;
            table.appendChild(newRow);
    
            // Reset modal
            document.getElementById("eventStartDate").value = '';
            document.getElementById("eventEndDate").value = '';
            document.getElementById("eventName").value = '';
            closeEventModal();
        }
    </script>

<script>
    let currentAcademicYear = "";
    let eventsByYear = JSON.parse(localStorage.getItem("eventsByYear")) || {};

    function openYearModal() {
        document.getElementById("yearModal").classList.remove("hidden");
    }

    function closeYearModal() {
        document.getElementById("yearModal").classList.add("hidden");
    }

    function changeAcademicYear() {
        const startDate = document.getElementById("startYearInput").value;
        const endDate = document.getElementById("endYearInput").value;

        if (!startDate || !endDate || new Date(endDate) <= new Date(startDate)) {
            alert("Please enter a valid date range.");
            return;
        }

        const start = new Date(startDate).getFullYear();
        const end = new Date(endDate).getFullYear();

        currentAcademicYear = `${start}-${end}`;
        document.getElementById("academicYearLabel").textContent = `Internship Calendar for Academic Year ${start}-${end}`;

        if (!eventsByYear[currentAcademicYear]) {
            eventsByYear[currentAcademicYear] = [];
        }

        saveEventsToStorage();
        renderEvents();
        closeYearModal();
    }

    function saveEventsToStorage() {
        localStorage.setItem("eventsByYear", JSON.stringify(eventsByYear));
    }

    function renderEvents() {
    const table = document.querySelector(".calendar-table tbody");
    table.innerHTML = "";

    const events = eventsByYear[currentAcademicYear] || [];
    events.forEach((event, index) => {
        const newRow = document.createElement("tr");
        newRow.innerHTML = `
            <td>${event.dateRange}</td>
            <td>${event.name}</td>
            <td class="flex gap-2">
                <button onclick="editEvent(${index})" class="text-blue-500 hover:underline">Edit</button>
                <button onclick="deleteEvent(${index})" class="text-red-500 hover:underline">Delete</button>
            </td>
        `;
        table.appendChild(newRow);
    });
}



function deleteEvent(index) {
    if (confirm("Are you sure you want to delete this event?")) {
        eventsByYear[currentAcademicYear].splice(index, 1);
        saveEventsToStorage();
        renderEvents();
    }
}

function editEvent(index) {
    const event = eventsByYear[currentAcademicYear][index];
    const [startDateStr, endDateStr] = parseDateRange(event.dateRange);
    
    document.getElementById("eventStartDate").value = startDateStr;
    document.getElementById("eventEndDate").value = endDateStr;
    document.getElementById("eventName").value = event.name;

    eventModal.classList.remove("hidden");

    document.querySelector("#eventModal button.btn:last-child").onclick = function () {
        const newStart = document.getElementById("eventStartDate").value;
        const newEnd = document.getElementById("eventEndDate").value || newStart;
        const newName = document.getElementById("eventName").value;

        const dateRange = formatDateRange(newStart, newEnd);
        eventsByYear[currentAcademicYear][index] = { dateRange, name: newName };
        saveEventsToStorage();
        renderEvents();
        closeEventModal();

        // Reset modal
        document.getElementById("eventStartDate").value = '';
        document.getElementById("eventEndDate").value = '';
        document.getElementById("eventName").value = '';
    };
}



    function formatDateRange(start, end) {
        const options = { month: 'long', day: 'numeric' };
        const startDate = new Date(start);
        const endDate = new Date(end);

        if (start === end || end === '') {
            return startDate.toLocaleDateString(undefined, options);
        }

        if (startDate.getMonth() === endDate.getMonth()) {
            return `${startDate.toLocaleDateString(undefined, { month: 'long' })} ${startDate.getDate()}–${endDate.getDate()}`;
        }

        return `${startDate.toLocaleDateString(undefined, options)}–${endDate.toLocaleDateString(undefined, options)}`;
    }

    function parseDateRange(rangeText) {
    // This is a very basic parser based on your format like: "December 12–15" or "December 12–January 15"
    const parts = rangeText.split("–");
    const todayYear = new Date().getFullYear();

    const start = new Date(`${parts[0]} ${todayYear}`);
    const end = parts[1] ? new Date(`${parts[1]} ${todayYear}`) : start;

    const toISOString = (d) => d.toISOString().split('T')[0];
    return [toISOString(start), toISOString(end)];
}


    function addEvent() {
        const start = document.getElementById("eventStartDate").value;
        const end = document.getElementById("eventEndDate").value || start;
        const name = document.getElementById("eventName").value;

        if (!start || !name) {
            alert("Please enter at least a start date and event name.");
            return;
        }

        const dateRange = formatDateRange(start, end);

        const eventData = { dateRange, name };
        if (!eventsByYear[currentAcademicYear]) {
            eventsByYear[currentAcademicYear] = [];
        }

        eventsByYear[currentAcademicYear].push(eventData);
        saveEventsToStorage();
        renderEvents();
        closeEventModal();

        document.getElementById("eventStartDate").value = '';
        document.getElementById("eventEndDate").value = '';
        document.getElementById("eventName").value = '';
    }

    function closeEventModal() {
        document.getElementById("eventModal").classList.add("hidden");
    }

    window.onload = () => {
        const stored = Object.keys(eventsByYear);
        if (stored.length > 0) {
            currentAcademicYear = stored[stored.length - 1];
            const [start, end] = currentAcademicYear.split("-");
            document.getElementById("academicYearLabel").textContent = `Internship Calendar for Academic Year ${start}-${end}`;
            renderEvents();
        } else {
            openYearModal();
        }
    };
</script>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>

<script>
  let chart;

  document.getElementById('excelFile').addEventListener('change', handleFile, false);

  function handleFile(e) {
    const file = e.target.files[0];
    const reader = new FileReader();

    reader.onload = function (e) {
      const data = new Uint8Array(e.target.result);
      const workbook = XLSX.read(data, { type: 'array' });

      const sheet = workbook.Sheets[workbook.SheetNames[0]];
      const json = XLSX.utils.sheet_to_json(sheet);

      const schoolCounts = {};
      let submitted = 0, notYet = 0;

      json.forEach(row => {
        const school = row["School"];
        const status = row["Status"];

        if (school) {
          schoolCounts[school] = (schoolCounts[school] || 0) + 1;
        }

        if (status === "Submitted") submitted++;
        else if (status === "Not yet") notYet++;
      });

      renderChart(schoolCounts);
      renderStatusList(submitted, notYet);
    };

    reader.readAsArrayBuffer(file);
  }

  function renderChart(data) {
    const ctx = document.getElementById('schoolChart').getContext('2d');
    if (chart) chart.destroy();

    chart = new Chart(ctx, {
      type: 'doughnut',
      data: {
        labels: Object.keys(data),
        datasets: [{
          data: Object.values(data),
          backgroundColor: ['#60A5FA', '#FBBF24', '#34D399', '#F87171', '#A78BFA'],
        }]
      },
      options: {
        responsive: true,
        plugins: {
          legend: { position: 'bottom' }
        }
      }
    });
  }

  function renderStatusList(submitted, notYet) {
    const list = document.getElementById("statusList");
    list.innerHTML = `
      <li><strong>Submitted:</strong> ${submitted}</li>
      <li><strong>Not yet:</strong> ${notYet}</li>
    `;
  }

  function notifyRemaining() {
    alert("Reminder sent to those who haven’t submitted their evaluation forms.");
  }
</script>
 
</body>

<script src="/templates/_components/_components.js"></script>
<script src="/templates/_components/content.js"></script>